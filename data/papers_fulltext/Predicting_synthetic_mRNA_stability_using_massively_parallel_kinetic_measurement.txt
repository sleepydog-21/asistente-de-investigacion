Engineering high-performance genetic systems requires the development of more comprehensive design platforms that can better predict how genetic sequence controls gene expression levels. While there are sequence-to-function models that are commonly used to predict bacterial transcription initiation rates and translation initiation rates

A key challenge to predicting mRNA decay rates is that degradation is controlled by several coupled interactions, involving ribosome protection, mRNA structure, G-quadruplexes, RNase binding sites, RNA modifying enzymes, and other RNA-binding proteins

Our model-building efforts relied on extensive past work identifying the enzymes responsible for mRNA degradation, including the endonucleases RNase E

We designed 62,120 5′ UTRs using combinations of sequence determinants that are proposed to alter mRNA decay rates, including: (1) the RppH binding site, which includes the first four nucleotides of the mRNA transcript; (2) the length and sequence composition of single-stranded (unstructured) regions in the 5′ UTR; (3) the sizes and folding energetics of mRNA secondary structures, varying the number of mRNA hairpins, bulges, internal loops within the 5′ UTR; (4) the presence of mRNA tertiary structures, including G-quadruplexes and i-motifs; and (5) designed ribosome binding site sequences that systematically varied the translation rate of a protein coding sequence (CDS).

Each designed mRNA transcript contains combinations of these factors to broadly explore the sequence-structure-function space, collected together into design groups. For example, in one design group, we designed 1280 5′ UTR sequences where each sequence varied the RppH binding site sequence (256 variants), followed by a single-stranded region (a 16-nt polyA motif) and a different ribosome binding site sequence (5 variants) that varied the CDS translation rates across a 10,000-fold range. We created four more design groups (1116 to 1772 designed sequences each) that systematically varied the RppH binding site and CDS translation rate, while varying the sequence and composition of the single-stranded RNA (ssRNA) region using polyU, AAACAAA, AAAGAAA, or UUUGUUU motifs. We created six more design groups (1170 to 8338 designed sequences each) that systematically varied the sequence and structure of the upstream 5′ UTR region, either utilizing polyA, polyG, polyC, or polyU tracts of varying length, shortening the region to 6-nt, inserting mRNA hairpins with varying duplex lengths (2, 8, or 16 duplexed base pairings), or removing the upstream region completely, all while varying the RppH binding site and CDS translation rates in each design group.

The next several design groups tested the importance of specific types of mRNA structures or binding sites. We began with designing 8073 5′ UTR sequences that have highly diverse sequences, but where subsets of sequences fold into a targeted secondary structure, using our recently developed Non-Repetitive Parts Calculator with an RNA structural constraint to carry out rational design

Each 5′ UTR was encoded within a 170-nt oligonucleotide that is paired to a distinct DNA barcode sequence. All oligonucleotides contain flanking PCR primer binding sites and two pairs of restriction sites to support 2-step library-based cloning. Oligonucleotides were synthesized in five separates oligopools (Genscript). Each oligopool was then PCR amplified, digested, and ligated into a plasmid-based expression system, followed by a second round of digestion and ligation to insert a constant sfGFP coding sequence (Methods). The final library of barcoded genetic systems uses a constant bacterial promoter (J23100) and the designed 5′ UTR to express the sfGFP reporter. However, we do not use the sfGFP reporter for measuring protein levels; instead, its purpose is to create a nominal expression environment where ribosomes bind to the mRNA transcript and provide protection against RNases, depending on its translation rate (Fig.

We then carried out massively parallel mRNA level measurements to determine the steady-state and kinetic decay rates of each engineered mRNA transcript (Methods). Mixed cell libraries were serially cultured in selective LB media at 37 °C so that all cells were maintained in the exponential growth phase for at least 4 h. At the starting timepoint (T0), cell samples were taken, followed by addition of rifampicin. Rifampicin directly binds to

For each 5′ UTR variant, we then quantified its mRNA levels over each timepoint and assessed how well the kinetic mRNA levels match to an exponential decay curve. We quantified mRNA levels by dividing the mRNA barcode counts at each timepoint by the DNA barcode counts at the T0 timepoint. We then compared the kinetic mRNA levels to the exponential curve

Our first data analysis step was to determine how the sequence design factors affected the measured mRNA decay rates. Initially, we compared how changing a single design factor altered mRNA decay rates. However, we found that focusing on only a single design factor resulted in larger intra-category differences than inter-category differences, indicating that multiple factors are collectively controlling the mRNA’s decay rate with equally important contributions (

We next applied multi-factor categorization to determine how individual design factors controlled mRNA decay rates. We collected together characterized mRNAs that had RppH binding sites that were more likely to confer greater mRNA stability (20 most stable RppH binding sites) as well as characterized mRNAs that had either high or low predicted CDS translation rates (higher or lower than 5000 au on the RBS Calculator v2.1 scale). We also collected together mRNAs that had moderate amounts of ssRNA in their 5′ UTR (11 to 40 nt). Notably, when we focus on mRNAs with stable RppH binding sites and moderate ssRNA lengths, we find an inverse relationship between the CDSs’ predicted translation initiation rates and their measured decay rates (Pearson

In another example, we found that increasing the amount of ssRNA in the 5′ UTR increased the mRNAs’ decay rates, but the relationship only becomes clear when the analysis focused on mRNAs with both stable RppH binding sites and high predicted translation initiation rates (Fig.

Finally, we found that G-quadruplex tertiary structures had a protective effect on mRNA stability, generally lowering their decay rates, while i-motif tertiary structures had no apparent protective effect on mRNA stability (Fig.

We next developed a quantitative sequence-to-function model that predicts a bacterial mRNA’s decay rate, combining both biophysical model calculations and machine learning to quantify the most important design factors that control mRNA stability (Fig.

Based on our prior data analysis, we found that the first four nucleotides of the mRNA transcript (the RppH binding site) have a particularly outsized impact on a mRNA’s decay rate. From that, we recognized that small differences in the promoter’s transcriptional start site will generate distinct mRNA isoforms with different RppH binding sites. Notably, a key advantage of the Promoter Calculator model is its ability to predict the transcription initiation rate for each potential start site. We accordingly applied the Promoter Calculator to calculate the five most predominant mRNA isoforms, ranked according to their predicted transcription initiation rates. For each distinct mRNA isoform sequence, we then separately calculated their structural and functional features (Fig.

We began the model training and testing procedure by combining the isoform-specific features and mRNA level measurements (steady-state levels and 4 kinetic levels per mRNA) into an augmented dataset, following by randomized splitting into a training dataset (36,219 mRNAs) and an unseen test dataset (9064 mRNAs). Importantly, to develop a more generalized model, we randomly split the mRNAs in each design group into training and test datasets to ensure that the same fraction of each design group was uniformly represented in both datasets. Using the training dataset, we then carried out machine learning using a gradient boosting algorithm (LightGBM v3.3.2), followed by testing on the unseen test dataset. We first developed five independently trained models, one to predict steady-state mRNA levels and four to predict mRNA levels at each post-rifampicin kinetic timepoint (Fig.

Gradient boosting uses a learned decision tree with automatic feature categorization to develop an ensemble of weak models that are summed together to predict the outcome. LightGBM is an enhanced gradient boosting algorithm that rapidly sub-divides numerical features (e.g., the predicted translation initiation rates) into optimal discrete bins for improved model accuracy. LightGBM also quantities the importances of each isoform-specific feature, enabling the removal of features that do not affect the outcome. Through iterative development, we identified a single set of hyperparameters (Supplementary Table

During model development, we eliminated several candidate features that had low importances when predicting mRNA levels, including mRNA hairpin heights, the lengths of mRNA internal loops, and the number of mRNA bulges. We confirmed that changing these mRNA structural factors, while keeping other factors constant, did not significantly alter the mRNAs’ measured decay rates (Supplementary Fig.

As we have shown, several interactions work together in a coupled fashion to collectively control mRNA decay rates, making it a challenge to directly analyze data and disentangle cause-effect relationships to use as design rules. However, by using the developed LightGBM model as a predictor, we can now carry out a systematic variation of the interactions and quantitatively determine how they each individually alter mRNA stability. We first selected a baseline mRNA with sequence, structural, and functional features that confer high mRNA stability, followed by systematically changing single feature values across the physiologically relevant range (Fig.

We then systematically varied the baseline mRNA’s translation initiation rate and found that the LightGBM model predicted a sigmoidal effect on the steady-state mRNA level with a ceiling plateau at around 50,000 au on the RBS Calculator 2.1 scale (Fig.

We designed 62,120 5′ UTRs to quantitatively determine how a mRNA’s sequence controls its decay rate via combinations of sequence, structural, and functional features (Fig.

Cloning and characterization of the cell library yielded exceptional coverage in terms of both breadth and depth (Supplementary Data

Notably, when we quantified mRNA decay rates, it was essential to apply the RNA spike-in controls for normalization of the kinetic mRNA levels. When carrying out typical RNA-Seq measurements, the total RNA mass across a cell library is about the same across samples even if individual variants have higher or lower relative frequencies. However, after subjecting our cell library to rifampicin treatment, we expected and found that the total RNA mass was greatly reduced, particularly at the 16-min timepoint, invalidating that typical assumption (Supplementary Data

As another notable finding, we found that differences in a UTR variant’s steady-state mRNA level were not indicative of its mRNA decay rate. Typically, gene expression models assume that the steady-state mRNA concentrations depend on the ratio between transcription initiation rates and mRNA decay rates such that there should be a proportional relationship between a mRNA’s decay rate and the inverse of its steady-state mRNA level. Here, we found an unexpected non-linear, sigmoidal-like relationship between the UTR variants’ inverse steady-state mRNA levels and mRNA decay rates (Supplementary Fig.

Overall, a key conclusion of this work is that the sequence determinants that control mRNA decay are highly entangled; small changes to the 5′ UTR sequence can alter both structural and functional features, affecting the strengths of multiple interactions at the same time, making it challenging to directly elucidate cause-effect relationships. For example, a few nucleotide changes can alter both a mRNA’s structure as well as its translation rate, both affecting mRNA decay rates via distinct and potentially opposing mechanisms. Multi-factor categorization could somewhat disentangle individual contributions (Fig.

We found four types of interactions that primarily controlled mRNA stability and decay rates. The first four nucleotides of a mRNA can alter mRNA stability by up to fourfold (Fig.

Second, the mRNA’s translation initiation rate can alter its stability by over 10-fold (Fig.

Third, longer regions of unstructured mRNA in the 5′ UTR lowered mRNA stability by creating more landing pads for RNase E/G binding and more potential cleavage sites for initiating processive mRNA degradation (Fig.

Finally, through our analysis and model development, we found that mRNA structures only provided protection from RNase activity by lowering the lengths of ssRNA regions. When keeping the amount of unstructured mRNA constant, the addition of mRNA duplexes and hairpins did not improve mRNA stability (Fig.

The effects of most of these interactions are likely to be conserved across many bacterial species as they depend mainly on the biophysics of RNA folding and foundational binding mechanics. The enzymes in the RNA degradosome are well-conserved across most bacterial species; for example,

We developed the predictive model of mRNA stability—named the mRNA Stability Calculator—to quantitatively fill key gaps in the sequence-function relationships that control gene expression levels. Notably, the same sequence determinant can affect multiple gene expression steps. For example, the first four nucleotides of a mRNA transcript will affect both its transcription initiation rate and its decay rate. A mRNA’s UTR region controls both its translation initiation rate and its decay rate. If not considered, these entanglements will have a misleading effect on analysis outcomes. Accordingly, we applied predictive models of transcription and translation to disentangle these sequence determinants and to develop a comprehensive of mRNA decay. By combining these models together, we now have the potential to accurately predict sequence-function relationships across diverse bacterial genetic systems. The developed models and design rules have been combined with sequence optimization algorithms to automatically design genetic systems with targeted transcription, translation, and mRNA decay rates. The source code for training and testing the mRNA Stability Calculator is available at

62,120 5′ UTR sequences were designed to systematically vary sequence, structural, and functional determinants. Each UTR variant was assigned a unique 15-nucleotide barcode sequence with pairwise Hamming distances greater than 2. 62,120 oligonucleotides were then designed, using the same pair of designed primer binding sites and four restriction sites to facilitate PCR amplification of the oligopool and two-step library-based cloning into the vector. Restriction sites for AvrII and AatII are used to insert the oligopool into the vector to create an intermediate plasmid library. Restriction sites SacI and EcoRI are used to insert a sfGFP CDS into the intermediate plasmid library to create the final plasmid library. Padding sequences were added to ensure that all oligonucleotides are 170-nucleotides long. The oligopool was split into five equal portions and synthesized by Genscript. All designed UTR sequences and constant regions are listed in Supplementary Data

The five oligopools were separately amplified by PCR using 22 cycles, followed by gel separation, and extraction. The five fragment mixtures and a pFTV1-derived vector were separately digested using AvrII and AatII (37 °C for 6 h), purified, ligated (300 fmoles digested oligopool per 30 fmoles digested vector), and transformed into

An entire cryostock was resuspended in 100 mL of LB media supplemented with 50 μg/mL Chloramphenicol (Cm) in a 1 L Erlenmeyer flask and incubated at 37 °C, 300 RPM agitation for 12 h. Afterwards, it was diluted to an OD

Spike-in control RNA was produced using HiScribe T7 High Yield RNA Synthesis (NEB) from a linear DNA template that uses a T7 promoter to produce mRNA of similar size to the designed mRNAs with identical sites for cDNA synthesis and PCR amplification of the barcode region, though using a distinct barcode sequence. The concentrations of the extracted total RNA from the cell library and the spike-in control RNA were measured with the Quant-iT RNA assay (Thermo Fisher). Spike-in control RNA and total RNA were combined at the ratio of 10 attomoles of spike-in control to 1 μg of total RNA. Samples were then depleted of rRNA (NEBNext rRNA depletion, NEB), followed by cDNA synthesis (SuperScript IV first-strand synthesis, Invitrogen) using a reverse transcript-specific primer that binds upstream of the barcode region. Barcoded amplicon library generation for DNA-Seq and RNA-Seq were then carried out via PCR amplification of the barcode region of the either the purified plasmid DNA or the purified cDNA, respectively, using 25 cycles and gel extraction. DNA amplicon libraries were then submitted for deep sequencing, which includes adapter library preparation and flow cell loading (Illumina NovaSeq, Genewiz). Read counts were determined from FASTQ files by mapping and counting barcode sequences, employing a hash look-up table and multi-threaded operation. All barcode sequences were designed to have pairwise Hamming distances greater than 2, enabling unique barcode mapping with at most one nucleotide mutation.

mRNA decay rates were determined from the DNA-Seq read counts, RNA-Seq read counts, and spike-in control RNA read counts at the 0, 2, 4, 8, and 16 min post rifampicin timepoints. RNA-Seq read count ratios (

LightGBM models to predict mRNA levels at each timepoint were independently trained and tested using the natural log of the

Further information on research design is available in the



Supplementary Information

Description of Additional Supplementary Files

Supplementary Data 1

Supplementary Data 2

Reporting Summary

Transparent Peer Review file