The 16S rRNA gene is a key marker for bacterial identification

The introduction of third generation, or long-read, sequencing technologies has enhanced NGS capabilities by allowing the sequencing of longer DNA segments. This advancement has revolutionised 16S rRNA gene studies, allowing for full-length 16S gene sequencing (~ 1500 bp), thereby substantially improving phylogenetic resolution, often to the species level

Here, we aim to benchmark the various steps involved in RRN sequencing, including primer selections, sequencing platforms, and classification methods. While four RRN primer pairs have been documented in previous publications, this is the first to compare all four directly. We tested these primers using four compositionally distinct mock communities: the first mirrors real environmental samples (ATCC); the next two, developed in-house, contain closely related species of the same genus and each community pooled with a different strategy to assess RRN primer biases (MCAP and MCGD); and the final one is logarithmically distributed containing very low abundance members to assess sensitivity and limits of detection (Zymo). The inclusion of the four mock communities allows a more robust assessment of RRN sequencing biases. Furthermore, this study compares the two widely adopted long-read sequencing platforms, PacBio and ONT, with the aim of assessing their advancements in terms of accuracy and their suitability for achieving species-level resolution when RRN sequencing. Classification tools are identified as confounding factors in RRN sequencing, for which we compared two methods: (i) direct alignment of reads to a reference database using Minimap2, and (ii) OTU clustering using vsearch (common practice in short-read 16S amplicon sequencing), followed by classification with QIIME2’s BLAST classifier. We evaluated the performance of these classification tools in combination with publicly available RRN reference databases, MIrROR

The general workflow employed in this study is illustrated in Fig.



Overview of study design: (

At both species and genus levels, the ATCC mock community, was the only community to exhibit a notable difference between the four RRN amplicons (Fig.

At genus level for the PacBio data, the post hoc test results largely mirrored the results at the species level (

For the other three mock communities, namely MCAP, MCGD and Zymo, at both species (Fig.

Here, most mock communities indicated that the selection of RRN amplicons did not substantially influence their taxonomic profiles. Once the effects of the RRN amplicons on the mock community taxonomic profiles were investigated, the RRN amplicons generated by one of the RRN primer pairs, being the 519F-2428R amplicons, were selected for further analysis based on their relatively lower Bray Curtis Dissimilarity values compared to the other RRN amplicons (Fig.



(

Community taxonomy profiles differed significantly among the various classification methods applied for each mock community at species level: ATCC (ONT:

At the species level, for ONT data where only MM methods were applied, MM_GROND-G outperformed the others, according to F1 score (ATCC = 0.54, MCAP = 0.79, MCGD = 0.88, Zymo = 0.57) (Fig.

At the genus level, higher F1 scores, precision and recall were observed compared to species level. However, the trends of classification method performance were largely consistent with the species level (Fig.



(

Following investigation into F1 scores, precision and recall, each of the classification methods were assessed in terms of the taxa detected and missed at genus and species levels along with their relative abundance estimates for the four mock communities.

The ATCC mock community was included to evaluate the performance of RRN sequencing on a diverse range of bacterial and archaeal species typical in environmental samples. Across both ONT and PacBio sequencing platforms, all RRN-based methods showed similar performance at the species level (Fig.

The in-house mock communities, MCAP and MCGD (Fig.

RRN-based methods were indeed more effective in distinguishing species within these communities than v3-v4 based methods (Fig.

The Zymo community (Fig.



Heatmaps demonstrating the Relative Abundance percentage estimates (RA% scale to the right of each plot) provided by each of the classification methods (x axis) for the species (y axis) present within the mock communities (

Advancements in long-read sequencing, such as PacBio’s HiFi sequencing and ONT’s Q20 + kit chemistry, have greatly enhanced the read accuracies of these technologies. Reduced sequencing costs, and improved reliability and accessibility, have initiated a shift from short-read sequencing of regions of the 16S rRNA gene to long-read sequencing of its full length. More recently, this progress has steered focus towards RRN sequencing, highlighting the push in microbiome research towards attaining more precise species-level resolution. In this study, we assessed the accuracy of species-level resolution provided by RRN sequencing identifying potential sources of biases in terms of choice of primer pairs and sequencing platforms alongside that of classifiers and databases, wherein the latter two had a significant impact on the accuracy of species-level resolution obtained by RRN sequencing. Aligning with the findings of Cuscó et al.

This study evaluated the primer-derived biases in RRN amplicon generation by using four combinations of previously published RRN primers, unlike previous studies which utilised just one primer pair. Our approach also involved comparing these primers across four compositionally distinct mock communities. We found that for most mock communities, the use of different RRN primer pairs did not significantly alter the taxonomic profiles or introduce substantial biases. However, we noted that the composition of the mock community itself was a crucial factor. When the ATCC community, containing a diverse array of bacterial species isolated from various environmental sources, was used, the 519F-2428R primer pair exhibited a slightly enhanced performance compared to other primer combinations. This advantage manifested as a higher number of true positive species detected and a reduced Bray Curtis Dissimilarity to the expected mock community. Similarly, reports from Kinoshita et al.

The ATCC mock community was included to evaluate the capability of RRN sequencing to detect archaeal species. Previous studies have indicated that the 519F-2428R primer pair is capable of identifying archaeal species

Classification method was observed to play a crucial role in our study, wherein we employed two methods for taxonomic classification of RRN amplicons. The first method involved direct alignment to reference sequences using Minimap2 (MM-based approaches), while the second utilised OTU clustering. In the OTU-based approach, vsearch was used to generate OTUs, which were then classified using QIIME2’s BLAST classifier (QB-based approaches). Both approaches had advantages and limitations, and their performance varied depending on the mock community. Generally of the classification methods, MM_GROND performed best, in terms of F1 score, precision, recall, and lower Bray Curtis Dissimilarity to the expected community. Substantially shorter run times observed for MM methods as opposed to QB methods, support the former’s applicability in sectors necessitating rapid and precise microbial profiling. However, faster run times can be achieved for QB methods, that employ OTU clustering, by implementing lower clustering thresholds (e.g., 97%), which alleviates the processing burden, without compromising the taxonomic resolution provided by QB methods, as evidenced by this study. Generally, MM-based approaches reported higher numbers of false positives, aligning with the findings of Cuscó et al.

We have demonstrated here that RRN sequencing has the ability to significantly enhance species-level resolution of microbial communities, however, identifying best practices within the field is crucial to realising the full benefits of this approach. Looking forward, we anticipate that the next phase in the development of RRN sequencing will involve efforts to achieve accurate strain-level resolution. Although few studies have ventured into employing RRN sequencing for this purpose, the outcomes have varied, particularly across different environments

The performance of RRN sequencing was assessed using four mock microbial communities, serving as simplified representatives of real microbiome samples. The first mock community, ATCC ABRF-MGRG (Cat No. MSA-3001), comprises an even mixture of genomic DNA (gDNA) from 10 microbial strains (9 bacteria, 1 archaea). This was selected to typify environmental microbiome samples. The second, ZymoBIOMICS™ DNA Standard II (Cat No. D6311), is a log-distributed mixture of gDNA isolated from 10 microbial strains (8 bacteria, 2 fungi).

In addition, an in-house mock community with 24 distinct microbial species was constructed. To compose this in-house community, the gDNA was extracted from pure cultures of bacteria species using the GenElute™ Bacterial Genomic DNA Kit (Sigma-Aldrich, Germany) according to manufacturer’s instructions. Two versions of the in-house mock community were developed. For the

Four RRN primers, 27F, 519F, 2241R, and 2428R, were selected based on their development in previous publications

Sequencing of the v3-v4 region of the 16S rRNA gene was also conducted using Illumina technology to compare with RRN sequencing at genus and species levels. The v3-v4 libraries were prepared following the procedures for Illumina 16S Metagenomic Sequencing Library Preparation

The pool of cleaned, barcoded RRN amplicons was sequenced using two long read platforms, Oxford Nanopore Technology (ONT, Oxford, UK) and PacBio (California, United States). One half of the pool of amplicons, was prepared for ONT sequencing according to the guidelines provided in the Nanopore protocol for PCR barcoding amplicons, version PBA96_9152_v112_revB_09Feb2022

The other half of the amplicon pool was prepared for PacBio sequencing according to the PacBio protocol for Preparing multiplexed amplicon libraries using SMRTbell prep kit 3.0

For the v3-v4 Illumina library, sequencing was carried out on the Illumina NextSeq 2000 at the Teagasc sequencing facility, using a 2 × 300 cycle v3 kit, following standard Illumina sequencing protocols. Demultiplexing of reads was performed on the NextSeq system. Primers were removed using Cutadapt v. 2.6. Details on each sample, including number of reads, median read lengths, and median read quality, are shown in Supplementary Table 10.

For the RRN amplicons, two primary approaches to compositional analysis were applied: (i) OTU clustering using vsearch

The following steps were performed using vsearch v. 2.22.1. FASTQ files from PacBio sequencing were quality (> Q12) and length filtered (3500–5000 bp) with --fastq_filter. Reads were then de-replicated using --derep_fulllength. Pre-clustering was performed to reduce the impact of sequencing error on chimera removal at 98% similarity threshold using --cluster_size.

FASTQ files from PacBio and ONT sequencing were quality filtered (> Q12) using Filtlong v. 0.2.0 and length filtered (3500–5000 bp) using Cutadapt v. 2.6. Chimeric reads were detected and removed using yacrd v. 1.0. Non-chimeric reads were then aligned against reference sequences within the various RRN databases employed using Minimap2 v. 2.17-r974 (MM) where seed length was provided with -z 70 and options map-ont and map-pb were used for ONT and PacBio datasets accordingly. The best alignment for each read against a reference sequence was identified and taxonomy was inferred based on the alignment that had the highest Smith-Waterman alignment (AS) score for a read, as suggested by Cuscó et al.

In our analysis, six distinct reference databases were utilised. Four of these databases contained sequences of the RRN operon, with the remaining two consisting of full-length 16S rRNA sequences. The rrnDB comprises 16S-ITS-23 S sequences extracted from a total of 67,199 bacterial genomes that have been retrieved from NCBI GenBank

Each of the four RRN databases, GROND-G, GROND-R, rrnDB, and MIrROR, were applied in combination with the Minimap2 (MM) classifier for ONT and PacBio RRN amplicon sequencing data. Of the three QIIME-based classifiers applied in combination with three of the four RRN databases, GROND-G, GROND-R, and rrnDB, only the QIIME-BLAST classifier was selected for further analysis of the PacBio RRN data at species and genus levels. While all three QIIME-based classifiers provided taxonomic profiles similar to the expected community (Supplementary Table 11), the QIIME-NB trained (QNBT) and QIIME-VSEARCH exact match + sklearn (QVPSK) classifiers were excluded from further analysis as they were observed to perform inconsistently even within the same mock community, cluster further away from the expected community (Supplementary Fig. 5), and report a higher number of unassigned taxa at the species level (Supplementary Fig. 6). The classification methods applied for the v3-v4 Illumina data included the QIIME-NB trained (QNBT) classifier with the Greengenes2 database at species and genus levels and the QIIME-NB trained (QNBT) classifier with the SILVA v138.1 database for genus level taxonomic assignments.

Statistical analysis was performed in R v.4.1.2. The vegan package v. 2.6.4

The accuracy of microbial taxa detection at both genus and species levels, in terms of their presence or absence, was evaluated using three metrics: precision, recall, and F1 scores. The R package yardstick v. 1.1.0 was used for these calculations. Precision measures the proportion of correctly identified true positives in relation to all claimed true positives. Recall, on the other hand, indicates the percentage of actual positives in the sample that were successfully detected by the classification methods. The F1 score, serving as a balance between precision and recall, is the harmonic mean of these two metrics. These three metrics were calculated in the following manner:

Below is the link to the electronic supplementary material.



Supplementary Material 1



Supplementary Material 2



Supplementary Material 3



Supplementary Material 4



Supplementary Material 5



Supplementary Material 6



Supplementary Material 7



Supplementary Material 8